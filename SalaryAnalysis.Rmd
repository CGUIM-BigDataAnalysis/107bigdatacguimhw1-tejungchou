---
title: "107-2 大數據分析方法 作業一"
output: github_document
author: 周德融

---

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**- [開放資料連結](https://data.gov.tw/dataset/6647)，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較103年度和106年度大學畢業者的薪資資料

### 資料匯入與處理
```{r dataload }
library(jsonlite)
library(dplyr)
library(tidyr)
library(readr)
X103education <- read_csv("~/Downloads/A17000000J-020066-Qod/103education.csv")
X104education <- read_csv("~/Downloads/A17000000J-020066-Qod/104education.csv")
X105education <- read_csv("~/Downloads/A17000000J-020066-Qod/105education.csv")
X106education <- read_csv("~/Downloads/A17000000J-020066-Qod/106education.csv")
X103<-X103education
X104<-X104education
X105<-X105education
X106<-X106education
#資料清洗for第一題
#將106「、」換成「-」
X106$大職業別<-gsub("_","、",X106$大職業別)
#103與106合併
join103106<-inner_join(X103,X106,by="大職業別")
#沒有數據無法比較（在此處我將它設為0）
join103106$`大學-薪資.x`<-as.numeric(gsub("—","0",join103106$`大學-薪資.x`))
join103106$`大學-薪資.y`<-as.numeric(gsub("—","0",join103106$`大學-薪資.y`))
#新增增加率欄位
join103106<-mutate(join103106,adrate=(join103106$`大學-薪資.y`)/(join103106$`大學-薪資.x`))
##資料清洗for第二題
#103
X103$`大學-女/男`<-gsub("…","0",X103$`大學-女/男`)
X103$`大學-女/男`<-gsub("—","0",X103$`大學-女/男`)
X103$`大學-女/男`<-as.numeric(X103$`大學-女/男`)
#104
X104$`大學-女/男`<-gsub("…","0",X104$`大學-女/男`)
X104$`大學-女/男`<-gsub("—","0",X104$`大學-女/男`)
X104$`大學-女/男`<-as.numeric(X104$`大學-女/男`)
#105
X105$`大學-女/男`<-gsub("…","0",X105$`大學-女/男`)
X105$`大學-女/男`<-gsub("—","0",X105$`大學-女/男`)
X105$`大學-女/男`<-as.numeric(X105$`大學-女/男`)
#106
X106$`大學-女/男`<-gsub("…","0",X106$`大學-女/男`)
X106$`大學-女/男`<-gsub("—","0",X106$`大學-女/男`)
X106$`大學-女/男`<-as.numeric(X106$`大學-女/男`)
#把所有表格按照年份做成一份大表格
join103to106<-rbind(X103,X104,X105,X106)
##資料清洗for第3題
X106$`大學-薪資`<-gsub("—","0",X106$`大學-薪資`)
X106$`大學-薪資`<-as.numeric(X106$`大學-薪資`)
X106$`研究所及以上-薪資`<-gsub("—","0",X106$`研究所及以上-薪資`)
X106$`研究所及以上-薪資`<-as.numeric(X106$`研究所及以上-薪資`)
```

### 106年度薪資較103年度薪資高的職業有哪些? 
```{r compare103106}
#按照提高比例由大到小排序
join103106<-arrange(join103106,desc(adrate))
#呈現前十名資料
knitr::kable(head(join103106,10)$大職業別) 
#文字說明
##106年相對103年，大學畢業者薪資提高比例由大到小前十名為:
##1.其他服務業-技術員及助理專業人員 
##2.住宿及餐飲業-服務及銷售工作人員   
##3.用水供應及污染整治業-技術員及助理專業人員
##4.專業、科學及技術服務業-專業人員 
##5.其他服務業-技藝、機械設備操作及組裝人員
##6.營造業-服務及銷售工作人員
##7.其他服務業-專業人員 
##8.資訊及通訊傳播業-專業人員 
##9.不動產業-專業人員
##10.教育服務業-事務支援人員

```

### 提高超過5%的的職業有哪些? 
```{r over5}
#取出薪資增加超過5%的職業
s<-subset(join103106,adrate>1.05)
knitr::kable(s$大職業別)
```

### 主要的職業種別是哪些種類呢?
```{r mainType}
#切割取職業
cat<-c()
for(i in 1:58){
cat<-c(cat,strsplit(s$大職業別,"-")[[i]][1])
}
c<-as.data.frame(table(cat))
as.data.frame(c)%>%
  arrange(desc(Freq))
#文字說明
##由106年大學畢業薪資相對103年提高5%以上者可發現，主要職業有（以超過4項職業類別為參考依據）：
##用水供應及污染整治業(6項)
##服務業部門(5項)、教育服務業(5項)、其他服務業(5項)、
##專業、科學及技術服務業(5項)、資訊及通訊傳播業(5項)
##由此資料可看出用水供應業、服務業以及資訊科學類為最大宗
```

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 103到106年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?
```{r male}
#過濾掉值為0的項目再進行排序
#大學女/男<100即為男生薪資較女生薪資多
join103to106<-filter(join103to106,`大學-女/男`!="0")%>%
  arrange(`大學-女/男`)%>%
  filter(`大學-女/男`<100)
#由小到大前10
knitr::kable(head(join103to106,10)$大職業別)
#文字說明
##男生薪資比女生薪資高的前10名中，礦業及土石採取業（4項）、電力及燃氣供應業（2項）及教育服務業（2項）為最高
##且教育服務業中也有一項為機械設備操作及組裝人員
##因此可以推斷男生在從事篇機械設備操作等傳統產業上獲取薪資較女生高
```
### 哪些行業女生薪資比男生薪資多? 
```{r female}
join103to106<-rbind(X103,X104,X105,X106)
join103to106<-filter(join103to106,`大學-女/男`!="0")%>%
  arrange(desc(`大學-女/男`))%>%
  filter(`大學-女/男`>100)
#由大到小前10
knitr::kable(head(join103to106,10)$大職業別)
#文字說明
##女生薪資較男生高的職業別僅三項，相較於男生薪資較高的數量少非常多
##我認為男女同工不同酬的現象是存在的
```

## 研究所薪資差異

以106年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?
 
```{r grad}
#新增 研究所/大學薪資 欄位
X106<-mutate(X106,GtoUNG=(X106$`研究所及以上-薪資`)/(X106$`大學-薪資`))
#比值最大，也就是唸研究所最划算的職業
X106top<-filter(X106,GtoUNG!="NaN")%>%
  arrange(desc(GtoUNG))%>%
  head(10)
#為以下10種職業
knitr::kable(X106top$大職業別)
#文字說明
##前10大職業別多數為理工產業相關職業
##包括礦業、專業科學、工業等
##因此就讀二類組相關科系以薪資方面來看適合念研究所
```

## 我有興趣的職業別薪資狀況分析

### 有興趣的職業別篩選，呈現薪資
```{r like}
X106<-X106education
join103to106<-rbind(X103,X104,X105,X106)
prosel<-filter(join103to106,大職業別%in%"資訊及通訊傳播業-專業人員")
```

### 這些職業別研究所薪資與大學薪資差多少呢？
```{r likeGrad}
ungra<-as.numeric(prosel$`大學-薪資`)
gra<-as.numeric(prosel$`研究所及以上-薪資`)
ungra
gra
##比我想像中低很多 我認為大學畢業起薪要35K左右 研究所則要45k以上
gra-ungra
##相差大約4600~6400元 算是意料之中
##不會改變心意，仍舊會繼續讀研究所
##因為讀研究所後較好升遷
##且工程師多數拚年薪，而不是看月薪
##所以升遷快可以領越多年薪
```

